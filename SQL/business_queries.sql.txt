-- Overall KPIs
SELECT
  ROUND(SUM(sales), 2) AS total_sales,
  ROUND(SUM(profit), 2) AS total_profit,
  ROUND(AVG(discount), 2) AS avg_discount
FROM public.orders;

-- Year-wise trend
SELECT
  EXTRACT(YEAR FROM order_date) AS year,
  ROUND(SUM(sales), 2) AS total_sales,
  ROUND(SUM(profit), 2) AS total_profit
FROM public.orders
GROUP BY year
ORDER BY year;

-- Category performance
SELECT
  category,
  ROUND(SUM(sales), 2) AS total_sales,
  ROUND(SUM(profit), 2) AS total_profit
FROM public.orders
GROUP BY category
ORDER BY total_sales DESC;

-- Top products
SELECT
  product_name,
  ROUND(SUM(sales), 2) AS total_sales
FROM public.orders
GROUP BY product_name
ORDER BY total_sales DESC
LIMIT 10;

-- Loss-making products
SELECT
  product_name,
  ROUND(SUM(sales), 2) AS total_sales,
  ROUND(SUM(profit), 2) AS total_profit
FROM public.orders
GROUP BY product_name
HAVING SUM(profit) < 0
ORDER BY total_profit ASC
LIMIT 10;
